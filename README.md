# COMET Programming Language

**C**ompiled **O**ptimized **M**odular **E**xpression **T**ranslator

A lexer and parser that compiles the COMET programming language to LuaJIT bytecode.

## Features

- **Lexical Analysis**: Flex-based lexer for tokenization
- **Syntax Parsing**: Bison-based parser with full AST generation
- **Code Generation**: Emits valid Lua code during parsing
- **Bytecode Compilation**: Automatically compiles to LuaJIT bytecode

## COMET Language Features

COMET supports:
- **Variable declarations** with type annotations (bool, number, string, array)
- **Functions** with parameters, return types, and return statements
- **Operators**: arithmetic (+, -, *, /), comparison (==, !=, <, >, <=, >=), logical (&&, ||)
- **Compound assignments** (+=, -=, *=, /=)
- **Control flow**: conditional blocks and while-style loops with nesting support
- **Input/Output**: print() and input() operations
- **Expressions**: complex expressions with proper operator precedence
- **Comments**: lines starting with #

## Building

```bash
make
```

Requires: `flex`, `bison`, `gcc`, and `luajit`

## Usage

Compile a COMET source file to LuaJIT bytecode:

```bash
./parser <input_file> [output_bytecode]
```

**Examples:**
```bash
./parser program.comet output.bc       # Generates output.bc
./parser hello.comet                   # Generates a.out
```

The compiler will:
1. Parse the COMET source file
2. Generate intermediate Lua source (saved as `<output>.bc.lua`)
3. Compile to LuaJIT bytecode using luajit

## Running Bytecode

Execute the generated bytecode with:

```bash
luajit output.bc
```

## Example COMET Program

```comet
# Variables with type annotations
let x: number = 42
let y: number = 3.14

# Conditional blocks
(x == 42)?
print("equal")
done

# Functions with return statements
function add(a: number, b: number) -> number
  return a + b
done

# Loops
let i: number = 1;
until (i <= 5)?
  print(i)
  i += 1
done

# Function calls
print(x)
print(y)
print(add(x, y))
```

See `comprehensive_test.txt` for a complete test suite covering all COMET features.

## Implementation

- `lexer.l` - Flex lexical analyzer (COMET tokenization)
- `parser.y` - Bison parser with semantic actions (COMET to Lua translation)
- `Makefile` - Build configuration

The COMET compiler generates Lua code during parsing using semantic actions, which is then compiled to bytecode by LuaJIT.

## Clean

```bash
make clean
```

Removes compiled artifacts (parser binary and object files).
